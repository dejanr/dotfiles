function restore_prompt_after_nix_shell() {
  if [ "$PS1" != "$PROMPT" ]; then
    PS1=$PROMPT
    PROMPT_COMMAND=""
  fi
}

PROMPT_COMMAND=restore_prompt_after_nix_shell
if [[ $IN_NIX_SHELL != "" ]] || [[ $IN_NIX_RUN != "" ]]; then
  PROMPT="\w\[\033[0;32m\] [nix-shell] \$(gitHUD)\[\033[0m\] λ "
else
  PROMPT="\w\[\033[0;32m\] \$(gitHUD)\[\033[0m\] λ "
fi

export PS1=$PROMPT
